---
title: "Graphs for Animal Crrossing Presentation"
author: "Sidney"
date: "2023-03-05"
output: html_document
---

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(shiny)
library(shinydashboard)
library(lubridate)
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading libraries
```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(shiny)
library(shinydashboard)
library(lubridate)
```

## Loading the data
```{r message=FALSE, warning=FALSE}
bugs <- clean_names(read_csv(here("data","insects.csv")))
fish <- clean_names(read_csv(here("data","fish.csv")))
```

## Fixing error in data
```{r}
bugs[65,34] <- "Ins45"
```

## Cleaning up the "bugs" data frame
```{r}
bugs <- bugs %>% 
  select(-"critterpedia_filename", -"furniture_filename", -contains("id"), -contains("sh"), -contains("color"), -"number") %>% 
  mutate(category = "bugs")
```

## Cleaning up the "fish" data frame
```{r}
fish <- fish %>% 
  select(-"critterpedia_filename", -"furniture_filename", -contains("id"), -contains("sh"), -contains("color"), -"number", -"lighting_type", -"rain_snow_catch_up", -"size") %>% 
  mutate(category = "fish")
```

## Combining "fish" and "bugs" into the "museum" data frame
```{r message=FALSE, warning=FALSE}
museum <- full_join(fish, bugs)
```

## Pivoting the months & times into 2 columns
```{r}
 museum <- museum %>%
  pivot_longer(nh_jan:nh_dec,
               names_to = "month",
               names_prefix = "nh_",
               values_to = "times")
```

## Separating the "times" column into "start times" and "end times"
```{r message=FALSE, warning=FALSE}
museum <- museum %>% 
  filter(times != "NA") %>% 
  mutate_all(~ gsub("\\ ", " ", .)) %>% 
  replace(. == "All day", "0 AM – 24 AM") %>% 
  separate(times, into = c("start_times","end_times"), sep = " – ") %>% 
  separate(start_times, into = c("start_times","start_td"), sep = " ") %>% 
  separate(end_times, into = c("end_times","end_td"), sep = " ")
```

## Converting "start times" and "end times" to numerics
```{r}
museum$start_times <- as.numeric(museum$start_times)
museum$end_times <- as.numeric(museum$end_times)
```

## Converting all times to 24 hours
```{r}
museum <- museum %>% 
  mutate(start_times = ifelse(start_times == 12, 0, start_times)) %>% 
  mutate(start_times = ifelse(start_td == "PM",start_times+12,start_times)) %>%
  mutate(end_times = ifelse(end_times == 12, 0, end_times)) %>% 
  mutate(end_times = ifelse(end_td == "PM",end_times+12,end_times)) %>% 
  select(-"start_td",-"end_td")
```

## Converting "months" to factors based on the built in "month.abb" levels
```{r}
month.abb.l <- tolower(month.abb)
museum$month <- factor(museum$month, levels = month.abb.l)
```

```{r}
museum
```

##Graphs 

#Colors
```{r}
myColors <- c("#7BAFF7", "#A4D2F1", "#27A34D", "#A9F364", "#FCBBD3", "#F72D2D", "#FF800F", "#FFBE13", "#815800", "#B9923E", "#D6D1B2", "#6B87AE")
```

#Graph of Avg Sell Price in Each Month + Hour
```{r}
#copy month pal
museum$sell <- as.numeric(museum$sell)

sum_museum <- museum %>% 
  mutate(end_times = ifelse(museum$start_times > museum$end_times,museum$end_times + 24,museum$end_times)) %>% 
  group_by(name) %>% 
  summarize(n_months = mean(n_distinct(month)),
            n_hours = mean(end_times - start_times),
            sell = mean(sell)) 
  
sum_museum %>% 
  ggplot(aes(x=n_months,y=sell))+
  geom_boxplot(aes(group=n_months))+
  theme_classic()+
  scale_x_continuous(breaks = seq(1,12, by =1))

sum_museum %>% 
  ggplot(aes(x=n_hours,y=sell))+
  geom_boxplot(aes(group=n_hours))+
  theme_classic()+
  scale_x_continuous(breaks = seq(1,24, by =1))
```

avg sell price by month
```{r}
museum %>% 
  
  
```

density curve
```{r}
museum %>% 
  filter(category=="fish") %>% 
  ggplot(aes(x=sell))+
  geom_density()+
  facet_wrap(~where_how, ncol=4)+
  theme_classic()
```






